<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Timetable Solution Viewer</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container">
        <h1>School Timetable Solution Viewer</h1>
        <p class="subtitle">Enter a job ID, choose a class, and view its schedule grouped by days.</p>

        <!-- Endpoint Selection Section -->
        <div class="endpoint-section">
            <h2>Solve an Existing Problem</h2>
            <p class="endpoint-subtitle">Select a problem and click "Solve" to submit it</p>
            
            <div class="endpoint-controls">
                <select id="endpointSelect">
                    <option value="">-- Select a problem --</option>
                    <option value="/jobs/from-all-csv">Grades 1-12</option>
                    <option value="/jobs/from-all-csv-678-A-lim">Grades 6-8, A-lim</option>
                    <option value="/jobs/from-all-csv-678-AB">Grades 6-8, AB</option>
                    <option value="/jobs/from-all-csv-9-ABC">Grade 9, ABC</option>
                    <option value="/jobs/from-all-csv-9-ABC-lim">Grade 9, ABC-lim</option>
                </select>
                <button id="solveBtn" onclick="submitEndpoint()">Solve</button>
            </div>
            <div id="endpointStatus" class="endpoint-status"></div>

            <!-- File Upload Section -->
            <div class="file-upload-section">
                <h3>Or Solve Your Problem</h3>
                <p class="endpoint-subtitle">Upload your .csv files and click "Solve" to submit it</p>
                <div class="file-inputs">
                    <div class="file-input-group">
                        <label for="roomsCsvFile">Rooms .csv:</label>
                        <input type="file" id="roomsCsvFile" accept=".csv" />
                    </div>
                    <div class="file-input-group">
                        <label for="teachersCsvFile">Teachers .csv:</label>
                        <input type="file" id="teachersCsvFile" accept=".csv" />
                    </div>
                    <div class="file-input-group">
                        <label for="lunchGroupsCsvFile">Lunch Groups .csv:</label>
                        <input type="file" id="lunchGroupsCsvFile" accept=".csv" />
                    </div>
                    <div class="file-input-group">
                        <label for="lessonsCsvFile">Lessons .csv:</label>
                        <input type="file" id="lessonsCsvFile" accept=".csv" />
                    </div>
                    <div class="file-input-group">
                        <label for="classCountInput">Class Count (A,B,C...):</label>
                        <input type="number" id="classCountInput" min="1" value="1" />
                    </div>
                </div>
                <button id="uploadBtn" onclick="submitUploadedFiles()">Solve</button>
            </div>
            <div id="uploadStatus" class="endpoint-status"></div>
        </div>

        <!-- Existing Solution Viewer Section -->
        <div class="viewer-section">
            <h2>View Solution</h2>
            <p class="viewer-subtitle">Enter a job ID to view its solution</p>

            <div class="controls">
                <input type="text" id="jobIdInput" placeholder="Enter Job ID" />
                <button id="fetchBtn" onclick="fetchSolution()">Fetch Solution</button>
            <select id="classSelect" disabled onchange="renderSelectedClass()">
                    <option value="">Select class...</option>
                </select>
            </div>
        </div>

        <div id="status" class="status"></div>

        <div id="scoreSection" class="score-section">
            <div class="score-title">Solution Score</div>
            <div class="score-values">
                <div class="score-item">
                    <div class="score-label">Hard score</div>
                    <div id="hardScore" class="score-value">-</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Soft score</div>
                    <div id="softScore" class="score-value">-</div>
                </div>
            </div>
            <div id="constraintMatches" class="constraint-matches"></div>
        </div>

        <div id="timetableContainer" class="timetable-container">
            <table id="timetableTable"></table>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <div>Solving started, please don't close this page.</div>
        </div>

        <div id="emptyState" class="empty-state">
            <div class="empty-state-icon">ðŸ“‹</div>
            <p>No lessons found for this class.</p>
        </div>
    </div>

    <script src="/js/script.js"></script>
</body>
</html>
